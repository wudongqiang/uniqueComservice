package com.unique.core.util;

import java.security.SecureRandom;

import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.DESKeySpec;

public class DesUtil {  
    /** 加密、解密key. */  
    private static final String PASSWORD_CRYPT_KEY = "yuyou120";  
    /** 加密算法,可用 DES,DESede,Blowfish. */  
    private final static String ALGORITHM = "DES";  
    public static void main(String[] args) throws Exception {  
//        String md5Password = "离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅离开家阿斯顿浪费空间按劳动法快睡觉阿拉丁师傅{}adsfadsfadsfasdfandmsf打扫费拉对方将阿里对抗赛房间爱对方打算发打算发第三方阿斯顿发的说法第三方adsfadsfadsgfadgfsafga-ga-d=gf=adf-adsfzxcvzxcvnadf12312335rtq254hadsfnadskflmnzxc;lvkjadfklsadfnadsmfnzxcv,mnzdgjadfeoaidfjsadsf";  
//        String str = DesUtil.encrypt(md5Password);  
//        System.out.println("str: " + str);  
    	String str = "F42C812D3374ED6ECFC467CD036B491B014AADE1821DD0B5B0D4A33ADD948E6D634980421C869B7241F8F16B3F3E06EAC798FFD91FAE8FF8D6292B02D28AF38829DB4EE2B184CF7DD958608C91CCA163A014AE80F039210C2EC6FD63FCF7EAEA634980421C869B7235AED09762BEB0975882BD6E2161BC19634980421C869B7235AED09762BEB097EDB879817AC5B3842AB2351914F5DAA94393F8C8051EB5FADAB715851C21C1FC6582B7CA394CF79CB48A75CE9931021B634980421C869B7235AED09762BEB09772F40519C7C1553248813AE63507D70C445FA3C28BC24966FCD2A7FCFEE1A0D18059F85640520AEC2A40B95FE71BABD50883504C16881F67C0F3F96A386D92C7ACAB7C756F24C6D73BBB2F637D3C1FE407D2E9A44CD0455189CAFA1DBC37FB3CC4E627FDC7AC9D33C7D6785D8C27D1A2C060CAF11025CDC5EAE83EC5D5DF20AA28D51E6073E26DB21DE34D49AEF39ADE5D090D774B77D4DD5244B1849D76253BE47C73B6EED93591C4E627FDC7AC9D33F5FB5C73BE2F5644C060CAF11025CDC5CDF14FF609EE6817529CE4BF72B10E3E82E19DAA37E72A37C060CAF11025CDC5564B9A71321F22FA6676DE78494A521F3714C1D6BA2189B63BBB2F637D3C1FE47EF10722B9A92BA5529CE4BF72B10E3E8C3CF1B023B8E5C2C060CAF11025CDC58131375C7621946F3FB9479818D4EDBBCF07DF1DD6BB4E923F528A55E35BCA2B5D090D774B77D4DD34B1EEBBC709014AFA1021E991DFCBC9C58D17D256E0E60BD8DD096BEEBCDFD5D229A865B7DA776FE4DBE6CE5E1B5A8B1C56930C76B82CA62D9EC75EFF4B6EDE4C6767EED90963B958EFC9D321A4C07BF9AB4821653613190ED41B2BF91113C7D3E002C5D86872BB22EE632E2CDAE93EF081BE0C90B87E0FE1A118EA48DC37A101380BC8F26B17E0B0B4DA6753910D8572800E7F68A3B0EFE1948C893A7C5E3310FF7F83F2AFECB34A7D249F3B4AFC657D5D4261DC5A141822CBCD32857DB38F676A876EF522C31915659BDA7FB8078EEF0EBB0747F9CD0BE9F2D207D74869BE7DA79E5FCA6779E59B9F22ACABD1C4CDD1348D107923B16501380BC8F26B17E0B0B4DA6753910D85B1FAD3718DB6A53F21AC6D870547858EB1AED1774E037FDB6E7304D157C084EC2C971F56C8E78FBE84840093CEE54994FC12CDF8C90D4A83C2EA4B0400E2FFBDBBA9A07C64DDC6541E7DFDC36522C2A6F052A596426D45FF9437E73BC7F6106E7F38D86813A4597CDFB0D2C04EEEA84B10FF7F83F2AFECB3443D4D9A2A7CEDD848AD3F4A20A99DBDF453C47CD44197B3676A876EF522C3198071849D9F3D18FCD716B1F7717BFC30E9F2D207D74869BE7DA79E5FCA6779E5FB10440ADEE0C3FD99557A6830B37A7001380BC8F26B17E071224E55FE395F71FF80DE70F7BD0F7BB912591BBDC6776D10FF7F83F2AFECB37A346089669D2FB95155D602FDD3CD133C36A43A198FC914676A876EF522C319DFE8CB3FF25A6CB6E35E3084E58454B1E9F2D207D74869BE7DA79E5FCA6779E59F4EE20A8A639E64BF030F5E1BD2584801380BC8F26B17E0871693923BADD350463702AE258C028A698625E3E463A2D210FF7F83F2AFECB31B69FF2CC337FB9873FAE3D3ECF249EED5A307CA1B9ACDE0676A876EF522C31953AF7D42D848500EE35D8F06FE8C566FE9F2D207D74869BE7DA79E5FCA6779E53B3E309BC40F49534554AAAF1D15E60001380BC8F26B17E0871693923BADD3503FDECA47D0761B04382D24E72656A4F910FF7F83F2AFECB3716F027D52E3996F616C5E34370C11A4D5A307CA1B9ACDE0676A876EF522C3190D7E9627D94E9A96AAC7C1707B7B8A69E9F2D207D74869BE7DA79E5FCA6779E54EB735760F0A2E77D4653C88960E83B701380BC8F26B17E027875CC65FB9449027901B50E2446715E3BEC33046B1A75610FF7F83F2AFECB310C2017660D9292B12D5FC3DCD35B2FED5A307CA1B9ACDE0676A876EF522C319BDC5EA4A5908D882FF653F18218521D7E9F2D207D74869BE7DA79E5FCA6779E59988147135AC7836F0B227BA6E43705601380BC8F26B17E0A8BBD9108B44BD54002409D1DCD6D2DB8CBA23C4E0FFC98010FF7F83F2AFECB34480C7F71391FD1224ED109CC6B533D9F453C47CD44197B3676A876EF522C319BA59E93D946E6E6E5570B5C02E34B365E9F2D207D74869BE7DA79E5FCA6779E5E5C1CD1BF4AB563B6B558DB7FA2F0DEB01380BC8F26B17E0FECDD0EAF7BD8B4B65249A1E336ADB5E54052777EC674FBE10FF7F83F2AFECB356294ECEE05BB0873ED8E517F503A0B564EA7FA260E9302D676A876EF522C3194FC64F01AE1AEC3F840E68187318EE32E9F2D207D74869BE7DA79E5FCA6779E52BAB028846503D0E51C54424363AEF077BB3D5B850A776748A81B53207550250AE67E54E5028EE62C5F32151B2FF46F2561AB799E8C25CC492BD5A9B96BC123F3F19F31AA6271B777249488FC86DA2CD09848B1B5D589976A2256973E4A94E09D229A865B7DA776F4C7D82750BD96ED24D8FA7E33A079E9C01380BC8F26B17E05C5DD93A82738809331B253C65CD0970B16C180DDC44A23292BD5A9B96BC123FCAC7EBB67F416D80C5F32151B2FF46F20AD7E464F891BA26E568B6E46BA28A23285F7C88CE08DFB09F956FA8F31400CF06D2CF2BCDF49110894EA17D751DFBF0F6D5D209EFB4D80E07144F586D7A2695C5E1D67ADBD164D57482AF713DE2EEAEDC0F6A0A4BA0752ED7414F2C79AD50F6392B6942188DF7EC11603D29F192DD8832467C4E0FACF79668E8F4C344AF32478461C1E4996C9C4F121EC408F03CEA5C410081565CCC72B381CCB771149BF6D7FF95894C7E6C8C94AFAB7EE444F612128C70302D63FC7450F1E528BCCF62C90439000A38B2BBFF97C6221C95E311C9E763AB6B2D0CBF34621DFEF62EDD829967F909CF4F31FCCC0806DCB4210D85266BC521F99D645E75B68B9A4E08F97D095ACCDDCECAD2B8460A2F2A89BD5019855BD43735263FAB08D42E4CCE5A0DFC6406EB3336B18B42C547555C94D1626317EF06C228252335BB1AAA402C6826EF83753EC102A17E94CF3EDD1AD6B9F352F4E74B79A0719BF9A095F052A596426D45FF0131EA3602E40D8E1C35571782534B021F0E1DAF1F0C3E0732282EBCAD4CAFBA410081565CCC72B35B97600EC2B6AE2487B91CCDAD17E411AB7A2BBB2ECD98E8FFC13C827BB75D53FF95894C7E6C8C94BBA09A53D60F96098C70302D63FC74502B301AF2B9483FB2331B253C65CD09701C337F4685664442F8B84D1A99BDEAF42ADE32F8446737EA6D1B7CAE55692ECA08FE7F12308E2C3AB30FE4161320228AD6B41EBF35A229EF350CDED2B9EA38A063474979738BBDD99DB174EDD7DECC92414759DD61E67E5371EF01377D654CF8C415E264CEC0CC8009178C3B1ECB2B3DE92F98B43DD974BE1D38140B3AA69E092173B787861904BD9C28A3957EC6B3C912618ACE5B43F96019B579566B8AB5373F528A55E35BCA2B745A88BD33EDCBA804F9913287CD77089ED73DD93CAB7FA1F597B1318885226072FE978A29F491260490EF16294AF433E41591F7221DDAEBD9DD83E35E9A0AD86D913D2BC3633CA37BB77BD987EB1EBB97FCEA04825E913E77C9E5D0CE6881DB0CA5D345C249846A50BDEA332B854EBE513D5DAB8CF446851A689049EA2BD6A5BE247865CA1BD9652E40977A4E71FD24EC19B51104D53D273796B7494441E5288625E2BDA3CDAF06B4073D588C20D7B39AD6245A040AECDD0D38A30F461FD6A99DE37826717081925A7557E75014D74FC8EF6E8A029A9DC5D4E8D4CBE2763BD6C23687A89619508D3E701070AB2E385D3D78B065FD5AE6F84FD29A45107EA7D336A349FB64215AB52D2395C60F8E90F446CFF36A6F9EF060C602FD2E897BD6DE3AAF576EB2069CA9FAF858EEA0BCF53836A349FB64215AB5F935B1D7CA7BE5B6AA059EA56137EFD8EF72EF03D50C92332DD0A6F002C69E7EF468B05435A570FC64BCBCFC65B562C5001B18FA6354CA0E95214721D3F688430D38A30F461FD6A923D9A41E5D1CF5DB615AC1B76BCFCF1EECB4CF61E3F39B52F8EBCB735AFA5CC0CE95D7011B93E04FB6F84B25EC8229C1D554454A232F470C6F3A304D92BA35E8A6D3BBBA92F5F06FCB259D84432B55B0443DE7B9F92601127BB3D5B850A776748C46EEB7D90FCDA7C953EAECAF7FAE71AB012A6C29D1E21AD40D64F91ACA93A0592CC7A8878354FA4288849BCB58D51AE9DDD16082C1EFDEABCE01F2080E1EBD2DA1579C44FC2A9AE8B24DB039C4DE945F6932FFC2887F5B1CFF986A34A482A500E11E6C3BDECC4967D89B3D674DDCD63ECB1E06FCF91863128B740F0844701598505A68D23535297BB3D5B850A7767403E789952FBBEAC7BB0241FD60E464378CCB5CFD25BE6A4E4A7AC35409FCB14DAC4E2AA74246C432BC866F979E2BF5557BA8935EA9B37A7C36FF0EFCAAC241D9D229A865B7DA776FADBE1612B8DB2AFA3BBB2BC2F3D1FE3F97FCEA04825E913E3562ECC8E694A7752ED08377B656AA727BB77BD987EB1EBB97FCEA04825E913E77C9E5D0CE6881DB58591A054C2D5D02A4CD5FA76D042B97F96E1725866E4835329AC09B259796969DE37826717081921FC30944FFF7B686CE62D6C0EA5860673F053C93574A6BC4E29A816A70371F7E221A36506707B7446884F36CF0C80BAE6BC0A5DA506CB42F758C4A8C811EEF139FCC847C851C17FC5CE17C3943BBF512A706721EA2E39F44D58FC25849BD9D544448372E284292B4D9FD36A0C3C0B4F6251D0B35ED1970FA7EB882D28F1DFB65BAD8974DC3BF7F926A028DD30CE5B46782A4D1E4D983CBD3A16F9DDBBFB10395AA1143E848331066128B740F08447015D394685664D24E5F828CA90062D59846A314BF6771B6BCFDF7D8D44F435E27C159AEDBDE65D3ADB84374484CB2D77ABA8468B26B64698CD162D2D2E3B5A2F81A0D9ED378414B0AEB8C46EEB7D90FCDA7EBE764816CE6829E8D00FE7DDDCF2EA8C1FA1BF6D5BBB4BD17BE7BBE67DEA84249A968100523E09F9BF9CF263777EDE1FB25E8C30C90718D6041995FD3F6C8A6476F15D495B8C761FAF3CC2450F8E9F9E5D989942E7CB93727CA9F355E0DB6A18C46EEB7D90FCDA7E4E5F475207F8286249A8FA20A841CBEA6A76A583FAE63A3024710A2B897E7F82F4005B5B0FCCBA27249488FC86DA2CDBC866F979E2BF555AA6621A75AC20B82A6A76A583FAE63A336472C0A4CD77D086FA1E3C3CB4DA8818C46EEB7D90FCDA7E4E5F475207F828620ACC2DA875C9B08FAF3CC2450F8E9F9D70EA5BDC8B934150087A1B17E451C4C20EAB7090809960A2E02F7714021CD51DBBBF3C668F76C61BE439F54F6629554DD4D22D202AB40A2D1386AD477CD0DE6DC2F56DA554B589056ABAB3432DA73F94C0A1BAA131B0C198FDF937C7EEC0601A6A76A583FAE63A306D84F0D7618E9FC9BE87B9608EE46F9DC2F56DA554B589024380FC1FF2DCA92D62C02600A78A5DD5BD7EE48EBE3AA893EE007DA2EB7900819872222C054A07417BE7BBE67DEA8423E9AD0F26C185E533BD5FBB13C47051C7EC2E8D67EBCC8CC6746EE440E709ACBDFEA7156CF6F8ACD975A6C1CDA2039129DB174EDD7DECC9209C77C71E37E25B21CD355452779B9362FD8B5689ED1E2ED5DC57AECB3EE61396773918023C6EE44B85E0172AD8480B08C46EEB7D90FCDA78081DCB3213AC79438484F4CFC07CE907ED3FEEBC3E2A967E2AF760D7B2DAB4B222A116162B1AC896DAB8328099D3F44069626801D709013447C6C6F3C11C46CC531840B8D18B9ED6523FE3E15997BA8F8C40B0E710259E6D70DB56FAC397B0F14B046E90C9F31BB2882202AF950E89CD5022E2B7EBA0C9B0F93129F1C8E41E7FE516A777E4C5A014F769714335079EB376E25DF51C96F77";
        long start = System.currentTimeMillis();
    	str = DesUtil.decrypt(str);
    	System.out.println("endTime:" + (System.currentTimeMillis() - start));
        System.out.println("str: " + str);  
    }  
      
    /** 
     * 对数据进行DES加密. 
     * @param data 待进行DES加密的数�?
     * @return 返回经过DES加密后的数据 
     * @throws Exception 
     */  
    public final static String decrypt(String data) throws Exception {  
        return new String(decrypt(hex2byte(data.getBytes("utf-8")),  
                PASSWORD_CRYPT_KEY.getBytes()),"utf-8");  
    }  
    /** 
     * 对用DES加密过的数据进行解密. 
     * @param data DES加密数据 
     * @return 返回解密后的数据 
     * @throws Exception 
     */  
    public final static String encrypt(String data) throws Exception  {  
        return byte2hex(encrypt(data.getBytes("utf-8"), PASSWORD_CRYPT_KEY  
                .getBytes()));  
    }  
      
    /** 
     * 用指定的key对数据进行DES加密. 
     * @param data 待加密的数据 
     * @param key DES加密的key 
     * @return 返回DES加密后的数据 
     * @throws Exception 
     */  
    private static byte[] encrypt(byte[] data, byte[] key) throws Exception {  
        // DES算法要求有一个可信任的随机数�? 
        SecureRandom sr = new SecureRandom();
        // 从原始密匙数据创建DESKeySpec对象  
        DESKeySpec dks = new DESKeySpec(key);  
        // 创建�?��密匙工厂，然后用它把DESKeySpec转换�? 
        // �?��SecretKey对象  
        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);  
        SecretKey securekey = keyFactory.generateSecret(dks);  
        // Cipher对象实际完成加密操作  
        Cipher cipher = Cipher.getInstance(ALGORITHM);  
        // 用密匙初始化Cipher对象  
        cipher.init(Cipher.ENCRYPT_MODE, securekey, sr);  
        // 现在，获取数据并加密  
        // 正式执行加密操作  
        return cipher.doFinal(data);  
    }  
    /** 
     * 用指定的key对数据进行DES解密. 
     * @param data 待解密的数据 
     * @param key DES解密的key 
     * @return 返回DES解密后的数据 
     * @throws Exception 
     */  
    private static byte[] decrypt(byte[] data, byte[] key) throws Exception {  
        // DES算法要求有一个可信任的随机数�? 
        SecureRandom sr = new SecureRandom();  
        // 从原始密匙数据创建一个DESKeySpec对象  
        DESKeySpec dks = new DESKeySpec(key);  
        // 创建�?��密匙工厂，然后用它把DESKeySpec对象转换�? 
        // �?��SecretKey对象  
        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);  
        SecretKey securekey = keyFactory.generateSecret(dks);  
        // Cipher对象实际完成解密操作  
        Cipher cipher = Cipher.getInstance(ALGORITHM);  
        // 用密匙初始化Cipher对象  
        cipher.init(Cipher.DECRYPT_MODE, securekey, sr);  
        // 现在，获取数据并解密  
        // 正式执行解密操作  
        return cipher.doFinal(data);  
    }
    
    
    public static String byte2hex(byte[] b) {
    	StringBuilder hs = new StringBuilder ();  
        String stmp = "";  
        for (int n = 0; n < b.length; n++) {  
            stmp = (java.lang.Integer.toHexString(b[n] & 0XFF));  
            if (stmp.length() == 1)  
            	 hs.append("0").append(stmp);
            else  
            	hs.append(stmp);
        }  
        return hs.toString().toUpperCase();  
    }
    
//    public static byte[] hex2byte2(byte[] b) {  
//        if ((b.length % 2) != 0)  
//            throw new IllegalArgumentException("长度不是偶数");  
//        byte[] b2 = new byte[b.length / 2];  
//        for (int n = 0; n < b.length; n += 2) {  
//            String item = new String(b, n, 2);
//            b2[n / 2] = (byte)Integer.parseInt(item, 16);  
//        }  
//        return b2;  
//    } 

    public static int getASCIICode(byte b){
    	if(b>=0x30 && b <=0x39)
    		return b-0x30;
    	else{
    		return b-55;
    	}
    }
    
    public static byte[] hex2byte(byte[] b) {  
        if ((b.length % 2) != 0)  
            throw new IllegalArgumentException("长度不是偶数");  
        byte[] b2 = new byte[b.length / 2];  
        for (int n = 0; n < b.length; n += 2) {  
            b2[n / 2] = (byte) ((getASCIICode(b[n]) << 4) + getASCIICode(b[n+1]));  
        }  
        return b2;
    }  
}  
